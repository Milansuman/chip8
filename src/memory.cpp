#include "memory.h"
#include <cstddef>
#include <vector>

Memory::Memory(){
  //CHIP8 has 4kb memory
  this->memory = std::vector<unsigned char>(4096);
  
  std::vector<unsigned char> font = std::vector<unsigned char>({
    // "0"
    0xF0, 0x90, 0x90, 0x90, 0xF0,
    // "1"
    0x20, 0x60, 0x20, 0x20, 0x70,
    // "2"
    0xF0, 0x10, 0xF0, 0x80, 0xF0,
    // "3"
    0xF0, 0x10, 0xF0, 0x10, 0xF0,
    // "4"
    0x90, 0x90, 0xF0, 0x10, 0x10,
    // "5"
    0xF0, 0x80, 0xF0, 0x10, 0xF0,
    // "6"
    0xF0, 0x80, 0xF0, 0x90, 0xF0,
    // "7"
    0xF0, 0x10, 0x20, 0x40, 0x40,
    // "8"
    0xF0, 0x90, 0xF0, 0x90, 0xF0,
    // "9"
    0xF0, 0x90, 0xF0, 0x10, 0xF0,
    // "A"
    0xF0, 0x90, 0xF0, 0x90, 0x90,
    // "B"
    0xE0, 0x90, 0xE0, 0x90, 0xE0,
    // "C"
    0xF0, 0x80, 0x80, 0x80, 0xF0,
    // "D"
    0xE0, 0x90, 0x90, 0x90, 0xE0,
    // "E"
    0xF0, 0x80, 0xF0, 0x80, 0xF0,
    // "F"
    0xF0, 0x80, 0xF0, 0x80, 0x80
  });

  //Load the font data into memory
  for(int i=0; i<80; i++){
    this->memory.at(i) = font.at(i);
  }
}

unsigned char Memory::getByte(size_t pos){
  if(pos >= 4096){
    return this->memory.at(4095);
  }
  return this->memory.at(pos);
}

void Memory::setByte(size_t pos, unsigned char value){
  this->memory[pos] = value;
}

void Memory::loadBytes(const unsigned char* bytes, size_t pos, size_t n){
  for(size_t i=0; i<n; i++){
    this->memory.at(pos+i) = *(bytes+i);
  }
}